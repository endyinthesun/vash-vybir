import React, {useRef, useEffect} from 'react';

//components
import Header from '_components/header';
import Footer from '_components/footer';

//styles
import './sidebar.scss';
let scrollPosition = 0;

export default function Sidebar({
  onChangePage,
  page,
  sidebarOpen,
  setSidebarOpen,
}) {
  let clazz = 'sidebar';

  //Hooks and methods
  let burger = useRef(null);

  useEffect(() => {
    if (!sidebarOpen) {
      let scrollPrev = 0;
      window.addEventListener('scroll', () => {
        let scrolled = window.pageYOffset;

        if (scrolled > 250 && scrolled > scrollPrev) {
          burger.current.classList.add('hide');
        } else {
          burger.current.classList.remove('hide');
          burger.current.classList.add('scroll');
        }
        if (scrolled < 100)
        {
          burger.current.classList.remove('scroll');
        }
        scrollPrev = scrolled;
      });
    }
  }, [sidebarOpen]);

  const toggleSidebar = ({currentTarget}) => {
    if (!sidebarOpen) {
      scrollPosition = window.pageYOffset;
      currentTarget.classList.add('open');
      document.body.classList.add('sidebar-open');
      document.body.style.top = -scrollPosition + 'px';
      setSidebarOpen(true);
    } else {
      currentTarget.classList.remove('open');
      document.body.classList.remove('sidebar-open');
      document.body.style.top = '0px';
      window.scrollTo({
        top: scrollPosition,
        left: 0,
        behavior: 'instant',
      });
      burger.current.classList.remove('hide');
      setSidebarOpen(false);
    }
  };
  if (sidebarOpen) {
    clazz += ' open';
  }
  return (
    <aside className={clazz}>
      <div onClick={toggleSidebar} className="menu-btn" ref={burger}>
        <div className={'menu-btn_logo'}>
          <svg width="146" height="31" viewBox="0 0 146 31" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="28" height="31" transform="translate(118)" fill="white"/>
            <path d="M118 0V31H146V0H118ZM134.461 5.44922H141.078V25.5508H134.461V5.44922ZM119.641 1.81641H132.82V29.1836H119.641V1.81641ZM144.359 29.1836H134.461V27.3672H142.719V3.63281H134.461V1.81641H144.359V29.1836Z" fill="black"/>
            <path d="M124.416 13.5341L126.881 10.8049L128.041 12.0891L125.576 14.8183L124.416 13.5341Z" fill="black"/>
            <path d="M124.415 18.9097L126.88 16.1804L128.04 17.4646L125.575 20.1939L124.415 18.9097Z" fill="black"/>
            <path d="M135.954 13.5355L138.419 10.8063L139.579 12.0905L137.114 14.8197L135.954 13.5355Z" fill="black"/>
            <path d="M135.953 18.9106L138.418 16.1814L139.578 17.4656L137.113 20.1948L135.953 18.9106Z" fill="black"/>
            <path d="M121.281 3.63281V27.3672H131.18V3.63281H121.281ZM129.539 25.5508H122.922V5.44922H129.539V25.5508Z" fill="#EBAC0B" fill-opacity="0.9"/>
            <path d="M2.3976 22.2759H8.0568C8.4744 22.2759 8.8704 22.1967 9.2448 22.0383C9.6336 21.8655 9.972 21.6423 10.26 21.3687C10.5624 21.0807 10.8 20.7495 10.9728 20.3751C11.1456 20.0007 11.232 19.5975 11.232 19.1655C11.232 18.5175 11.052 17.9199 10.692 17.3727C10.332 16.8255 9.8496 16.4367 9.2448 16.2063C9.7344 16.0047 10.1448 15.6591 10.476 15.1695C10.8072 14.6799 10.9728 14.1759 10.9728 13.6575C10.9728 13.2687 10.9008 12.8943 10.7568 12.5343C10.6272 12.1599 10.4328 11.8359 10.1736 11.5623C9.9288 11.2743 9.6336 11.0511 9.288 10.8927C8.9424 10.7199 8.5608 10.6335 8.1432 10.6335H2.3976V22.2759ZM11.88 16.1199C12.024 16.2783 12.1608 16.4727 12.2904 16.7031C12.42 16.9335 12.528 17.1711 12.6144 17.4159C12.7152 17.6607 12.7872 17.9127 12.8304 18.1719C12.888 18.4167 12.9168 18.6471 12.9168 18.8631C12.9168 19.5687 12.7944 20.2311 12.5496 20.8503C12.3192 21.4695 11.988 22.0095 11.556 22.4703C11.1384 22.9311 10.6272 23.2983 10.0224 23.5719C9.432 23.8311 8.7768 23.9607 8.0568 23.9607H0.6912V8.92709H8.0568C8.7048 8.92709 9.3096 9.04949 9.8712 9.29429C10.4472 9.52469 10.944 9.85589 11.3616 10.2879C11.7792 10.7055 12.1104 11.2023 12.3552 11.7783C12.6 12.3399 12.7224 12.9447 12.7224 13.5927C12.7224 14.0535 12.6432 14.4999 12.4848 14.9319C12.3408 15.3495 12.1392 15.7455 11.88 16.1199ZM10.7352 19.1007C10.7352 19.4751 10.6632 19.8279 10.5192 20.1591C10.3752 20.4759 10.1808 20.7567 9.936 21.0015C9.7056 21.2319 9.4248 21.4191 9.0936 21.5631C8.7624 21.7071 8.4168 21.7791 8.0568 21.7791H2.8728V16.4439H8.0568C8.4168 16.4439 8.7552 16.5159 9.072 16.6599C9.4032 16.8039 9.6912 16.9983 9.936 17.2431C10.1808 17.4879 10.3752 17.7687 10.5192 18.0855C10.6632 18.4023 10.7352 18.7407 10.7352 19.1007ZM9.0288 19.1007C9.0288 18.8415 8.9352 18.6183 8.748 18.4311C8.5608 18.2439 8.3304 18.1503 8.0568 18.1503H4.5792V20.0727H8.0568C8.3304 20.0727 8.5608 19.9791 8.748 19.7919C8.9352 19.6047 9.0288 19.3743 9.0288 19.1007ZM8.0568 15.9687H2.8728V11.1303L8.2512 11.1087C8.5536 11.1087 8.8416 11.1807 9.1152 11.3247C9.3888 11.4687 9.6264 11.6631 9.828 11.9079C10.0296 12.1383 10.188 12.3975 10.3032 12.6855C10.4328 12.9735 10.4976 13.2615 10.4976 13.5495C10.4976 13.8807 10.4328 14.1903 10.3032 14.4783C10.1736 14.7663 9.9936 15.0255 9.7632 15.2559C9.5328 15.4719 9.2664 15.6447 8.964 15.7743C8.676 15.9039 8.3736 15.9687 8.0568 15.9687ZM8.7912 13.5495C8.7912 13.3479 8.7192 13.1751 8.5752 13.0311C8.4312 12.8871 8.2584 12.8151 8.0568 12.8151H4.5792V14.2623H8.0568C8.2584 14.2623 8.4312 14.1975 8.5752 14.0679C8.7192 13.9239 8.7912 13.7511 8.7912 13.5495ZM21.2353 8.92709C21.8977 8.92709 22.5241 9.05669 23.1145 9.31589C23.7049 9.57509 24.2161 9.92789 24.6481 10.3743C25.0945 10.8063 25.4473 11.3175 25.7065 11.9079C25.9657 12.4983 26.0953 13.1247 26.0953 13.7871V23.9607H24.3889V13.7871C24.3889 13.3551 24.3025 12.9519 24.1297 12.5775C23.9713 12.1887 23.7481 11.8503 23.4601 11.5623C23.1721 11.2743 22.8337 11.0511 22.4449 10.8927C22.0705 10.7199 21.6673 10.6335 21.2353 10.6335H18.7945C18.3625 10.6335 17.9521 10.7199 17.5633 10.8927C17.1745 11.0511 16.8361 11.2743 16.5481 11.5623C16.2601 11.8359 16.0297 12.1671 15.8569 12.5559C15.6985 12.9447 15.6193 13.3551 15.6193 13.7871V23.9607H13.9345V13.7871C13.9345 13.1247 14.0569 12.4983 14.3017 11.9079C14.5609 11.3175 14.9137 10.7991 15.3601 10.3527C15.8065 9.90629 16.3177 9.56069 16.8937 9.31589C17.4841 9.05669 18.1177 8.92709 18.7945 8.92709H21.2353ZM23.8921 17.8263V23.9607H22.2073V19.5543H17.8225V23.9607H16.1161V17.8263H23.8921ZM23.8921 17.3295H16.1161V13.7871C16.1161 13.4271 16.1881 13.0887 16.3321 12.7719C16.4761 12.4407 16.6633 12.1527 16.8937 11.9079C17.1385 11.6631 17.4193 11.4759 17.7361 11.3463C18.0673 11.2023 18.4201 11.1303 18.7945 11.1303H21.2353C21.5665 11.1303 21.8905 11.1951 22.2073 11.3247C22.5241 11.4543 22.8049 11.6343 23.0497 11.8647C23.3089 12.0807 23.5105 12.3399 23.6545 12.6423C23.8129 12.9447 23.8921 13.2687 23.8921 13.6143V17.3295ZM22.2073 13.7871C22.2073 13.5279 22.1065 13.3047 21.9049 13.1175C21.7177 12.9159 21.4945 12.8151 21.2353 12.8151H18.7945C18.5209 12.8151 18.2905 12.9087 18.1033 13.0959C17.9161 13.2831 17.8225 13.5135 17.8225 13.7871V15.6015H22.2073V13.7871ZM40.3559 8.92709H44.2655V23.9391H44.0279V23.9607H27.3311V8.92709H31.2191V20.0511H33.8543V8.92709H33.8759H37.7639H37.7855V20.0511H40.3559V8.92709ZM42.5375 22.2543L42.5591 10.5903H42.0623V21.7575H36.0359L36.0575 10.5903H35.5823V21.7575H29.5127V10.5903H29.0375V22.2543H42.5159H42.5375ZM53.0226 22.2759H58.6818C59.0994 22.2759 59.4954 22.1967 59.8698 22.0383C60.2586 21.8655 60.597 21.6423 60.885 21.3687C61.1874 21.0807 61.425 20.7495 61.5978 20.3751C61.7706 20.0007 61.857 19.5975 61.857 19.1655C61.857 18.5175 61.677 17.9199 61.317 17.3727C60.957 16.8255 60.4746 16.4367 59.8698 16.2063C60.3594 16.0047 60.7698 15.6591 61.101 15.1695C61.4322 14.6799 61.5978 14.1759 61.5978 13.6575C61.5978 13.2687 61.5258 12.8943 61.3818 12.5343C61.2522 12.1599 61.0578 11.8359 60.7986 11.5623C60.5538 11.2743 60.2586 11.0511 59.913 10.8927C59.5674 10.7199 59.1858 10.6335 58.7682 10.6335H53.0226V22.2759ZM62.505 16.1199C62.649 16.2783 62.7858 16.4727 62.9154 16.7031C63.045 16.9335 63.153 17.1711 63.2394 17.4159C63.3402 17.6607 63.4122 17.9127 63.4554 18.1719C63.513 18.4167 63.5418 18.6471 63.5418 18.8631C63.5418 19.5687 63.4194 20.2311 63.1746 20.8503C62.9442 21.4695 62.613 22.0095 62.181 22.4703C61.7634 22.9311 61.2522 23.2983 60.6474 23.5719C60.057 23.8311 59.4018 23.9607 58.6818 23.9607H51.3162V8.92709H58.6818C59.3298 8.92709 59.9346 9.04949 60.4962 9.29429C61.0722 9.52469 61.569 9.85589 61.9866 10.2879C62.4042 10.7055 62.7354 11.2023 62.9802 11.7783C63.225 12.3399 63.3474 12.9447 63.3474 13.5927C63.3474 14.0535 63.2682 14.4999 63.1098 14.9319C62.9658 15.3495 62.7642 15.7455 62.505 16.1199ZM61.3602 19.1007C61.3602 19.4751 61.2882 19.8279 61.1442 20.1591C61.0002 20.4759 60.8058 20.7567 60.561 21.0015C60.3306 21.2319 60.0498 21.4191 59.7186 21.5631C59.3874 21.7071 59.0418 21.7791 58.6818 21.7791H53.4978V16.4439H58.6818C59.0418 16.4439 59.3802 16.5159 59.697 16.6599C60.0282 16.8039 60.3162 16.9983 60.561 17.2431C60.8058 17.4879 61.0002 17.7687 61.1442 18.0855C61.2882 18.4023 61.3602 18.7407 61.3602 19.1007ZM59.6538 19.1007C59.6538 18.8415 59.5602 18.6183 59.373 18.4311C59.1858 18.2439 58.9554 18.1503 58.6818 18.1503H55.2042V20.0727H58.6818C58.9554 20.0727 59.1858 19.9791 59.373 19.7919C59.5602 19.6047 59.6538 19.3743 59.6538 19.1007ZM58.6818 15.9687H53.4978V11.1303L58.8762 11.1087C59.1786 11.1087 59.4666 11.1807 59.7402 11.3247C60.0138 11.4687 60.2514 11.6631 60.453 11.9079C60.6546 12.1383 60.813 12.3975 60.9282 12.6855C61.0578 12.9735 61.1226 13.2615 61.1226 13.5495C61.1226 13.8807 61.0578 14.1903 60.9282 14.4783C60.7986 14.7663 60.6186 15.0255 60.3882 15.2559C60.1578 15.4719 59.8914 15.6447 59.589 15.7743C59.301 15.9039 58.9986 15.9687 58.6818 15.9687ZM59.4162 13.5495C59.4162 13.3479 59.3442 13.1751 59.2002 13.0311C59.0562 12.8871 58.8834 12.8151 58.6818 12.8151H55.2042V14.2623H58.6818C58.8834 14.2623 59.0562 14.1975 59.2002 14.0679C59.3442 13.9239 59.4162 13.7511 59.4162 13.5495ZM66.8059 10.6335H66.3091V22.2543H67.5187L74.1067 11.0871H74.5603V22.2543H75.0355V10.6335H73.8259L67.2379 21.7575H66.8059V10.6335ZM64.6243 8.92709H68.4907V16.2927L72.8539 8.92709H76.7203V23.9607H72.8539V16.5519L68.4907 23.9607H64.6243V8.92709ZM81.6723 14.2623H85.4307C86.0931 14.2623 86.7195 14.3919 87.3099 14.6511C87.9003 14.9103 88.4187 15.2631 88.8651 15.7095C89.3115 16.1415 89.6571 16.6527 89.9019 17.2431C90.1611 17.8191 90.2907 18.4383 90.2907 19.1007C90.2907 19.7631 90.1683 20.3823 89.9235 20.9583C89.6787 21.5343 89.3331 22.0455 88.8867 22.4919C88.4547 22.9239 87.9435 23.2695 87.3531 23.5287C86.7627 23.7879 86.1219 23.9319 85.4307 23.9607H77.8059V8.92709H81.6723H89.5779V12.8151H81.6723V14.2623ZM87.8931 11.1303V10.6335H79.9875H79.5123V22.2543H85.5819C85.9851 22.2543 86.3667 22.1679 86.7267 21.9951C87.0867 21.8223 87.4035 21.5919 87.6771 21.3039C87.9651 21.0159 88.1883 20.6847 88.3467 20.3103C88.5195 19.9359 88.6059 19.5399 88.6059 19.1223C88.6059 18.7191 88.5195 18.3303 88.3467 17.9559C88.1883 17.5671 87.9651 17.2287 87.6771 16.9407C87.3891 16.6383 87.0507 16.4007 86.6619 16.2279C86.2875 16.0551 85.8771 15.9687 85.4307 15.9687H79.9875V11.1303H87.8931ZM85.4307 16.4655C85.7907 16.4655 86.1291 16.5375 86.4459 16.6815C86.7771 16.8111 87.0651 16.9983 87.3099 17.2431C87.5547 17.4735 87.7491 17.7543 87.8931 18.0855C88.0371 18.4023 88.1091 18.7479 88.1091 19.1223C88.1091 19.4679 88.0371 19.8063 87.8931 20.1375C87.7635 20.4543 87.5835 20.7351 87.3531 20.9799C87.1227 21.2247 86.8491 21.4263 86.5323 21.5847C86.2299 21.7287 85.8987 21.8007 85.5387 21.8007H79.9875V16.4655H85.4307ZM81.6723 20.0943H85.4307C85.6899 20.0943 85.9131 20.0007 86.1003 19.8135C86.3019 19.6119 86.4027 19.3815 86.4027 19.1223C86.4027 18.8487 86.3091 18.6183 86.1219 18.4311C85.9347 18.2439 85.7043 18.1503 85.4307 18.1503H81.6723V20.0943ZM95.54 23.9607H91.6304V8.92709H95.54V23.9607ZM93.8336 22.2543V10.6119H93.3368V22.2543H93.8336ZM106.378 13.7655C106.378 14.1399 106.306 14.4927 106.162 14.8239C106.018 15.1551 105.824 15.4431 105.579 15.6879C105.334 15.9183 105.046 16.1055 104.715 16.2495C104.398 16.3791 104.06 16.4439 103.7 16.4439H99.2285V11.1087H103.808C104.168 11.1087 104.499 11.1807 104.801 11.3247C105.118 11.4687 105.392 11.6703 105.622 11.9295C105.853 12.1743 106.033 12.4551 106.162 12.7719C106.306 13.0887 106.378 13.4199 106.378 13.7655ZM104.672 13.7655C104.672 13.5063 104.571 13.2831 104.369 13.0959C104.182 12.8943 103.959 12.7935 103.7 12.7935H100.935V14.7375H103.7C103.973 14.7375 104.204 14.6439 104.391 14.4567C104.578 14.2695 104.672 14.0391 104.672 13.7655ZM103.7 8.92709C104.391 8.95589 105.032 9.10709 105.622 9.38069C106.227 9.63989 106.745 9.98549 107.177 10.4175C107.609 10.8495 107.948 11.3607 108.193 11.9511C108.452 12.5271 108.581 13.1391 108.581 13.7871C108.581 14.4495 108.452 15.0759 108.193 15.6663C107.933 16.2567 107.581 16.7751 107.134 17.2215C106.702 17.6535 106.184 17.9991 105.579 18.2583C104.989 18.5031 104.362 18.6255 103.7 18.6255H100.935V23.9607H97.0469V8.92709H103.7ZM106.875 13.7655C106.875 13.3623 106.789 12.9735 106.616 12.5991C106.457 12.2103 106.234 11.8719 105.946 11.5839C105.673 11.2959 105.356 11.0655 104.996 10.8927C104.636 10.7199 104.254 10.6335 103.851 10.6335H98.7533V22.2543H99.2285V16.9407H103.7C104.146 16.9407 104.557 16.8543 104.931 16.6815C105.32 16.4943 105.658 16.2567 105.946 15.9687C106.234 15.6807 106.457 15.3495 106.616 14.9751C106.789 14.5863 106.875 14.1831 106.875 13.7655Z" fill="white"/>
          </svg>
        </div>
        <div className="menu-btn_burger" />
      </div>
      <div className="sidebar_wrapper">
        <Header onChangePage={onChangePage} page={page} />
        <Footer />
      </div>
    </aside>
  );
}
